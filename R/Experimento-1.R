dados <- read.table(text = "Modo	Carga	Average	Min	Max	Std. Dev.	Error %	Throughput	Received KB/sec	Sent KB/sec	Avg. Bytes	Time (sec)	Ramp-up (sec)
Síncrono	Média	10411	1064	41252	8786.99	0.000%	12.91017	7480.29	22.84	593316.6	70	60
Síncrono	Média	5589	1044	34292	5753.28	0.000%	13.39286	7759.97	23.70	593316.6	68	60
Síncrono	Média	23606	1036	58798	12110.62	0.000%	9.77178	5661.87	17.29	593316.6	83	60
Síncrono	Média	20703	1059	56300	11219.97	0.000%	11.91518	6903.78	21.08	593316.6	76	50
Síncrono	Média	19301	1068	54441	12038.60	0.000%	11.95987	6929.68	21.16	593316.6	76	50
Síncrono	Média	19597	1089	50794	11471.53	0.000%	12.20002	7068.82	21.59	593316.6	74	50
Síncrono	Média	23073	1113	53381	12007.68	0.000%	12.14947	7039.53	21.50	593316.6	68	40
Síncrono	Média	20120	1095	49544	11170.97	0.000%	13.41236	7771.26	23.73	593316.6	68	40
Síncrono	Média	21783	1081	49638	11684.85	0.000%	13.12948	7607.36	23.23	593316.6	69	40
Síncrono	Média	25289	1750	48758	10981.83	0.000%	13.54060	7845.57	23.96	593316.6	72	30
Síncrono	Média	30836	1288	60830	13690.69	0.000%	12.13363	7030.36	21.47	593316.6	75	30
Síncrono	Média	30111	1079	54071	13627.41	0.000%	12.18600	7060.70	21.56	593316.6	74	30
Síncrono	Média	23600	1504	46009	11300.14	0.000%	15.51944	8992.13	27.46	593316.6	57	20
Síncrono	Média	22769	1277	46731	11210.34	0.000%	15.82125	9169.54	28.00	593481.0	57	20
Síncrono	Média	22893	1294	47774	11446.61	0.000%	15.34914	8895.92	27.16	593481.0	59	20
Síncrono	Média	21949	1164	43456	10649.02	0.000%	16.40229	9506.30	29.02	593481.0	55	20
Síncrono	Média	22522	1175	47063	11696.66	0.000%	15.57883	9029.04	27.57	593481.0	58	20
Síncrono	Média	22927	1095	45807	11492.11	0.000%	15.54457	9006.69	27.51	593316.6	58	20
Síncrono	Média	37954	1170	88712	18043.74	0.110%	9.51844	5509.06	16.82	592668.6	95	10
Síncrono	Média	33645	1934	66817	15740.00	0.000%	11.97778	6941.97	21.20	593480.4	76	10
Síncrono	Média	33438	3071	84223	16265.64	0.110%	9.89465	5728.39	17.49	592833.0	92	10
Síncrono	Média	36944	1218	114946	18018.33	0.110%	7.88450	4563.36	13.94	592666.8	115	1
Síncrono	Média	45971	1246	122769	25704.97	0.110%	7.38324	4273.26	13.05	592668.6	123	1
Síncrono	Média	37460	4332	109096	18428.90	0.000%	8.29393	4805.59	14.68	593316.7	109	1
Assíncrono	Média	878	445	1508	283.46	0.000%	29.06495	3.55	51.43	125.0	31	30
Assíncrono	Média	608	443	1035	121.04	0.000%	29.52699	3.60	52.25	125.0	30	30
Assíncrono	Média	764	452	1291	189.95	0.000%	29.28145	3.57	51.81	125.0	31	30
Assíncrono	Média	5926	474	11224	3090.10	0.000%	29.22609	3.57	51.72	125.0	31	20
Assíncrono	Média	5515	554	10790	2957.85	0.000%	29.64793	3.62	52.46	125.0	30	20
Assíncrono	Média	5594	484	10901	3042.25	0.000%	29.53655	3.61	52.27	125.0	30	20
Assíncrono	Média	10756	562	21033	5932.64	0.000%	29.39375	3.59	52.01	125.0	31	10
Assíncrono	Média	10625	572	20807	5847.08	0.000%	29.60270	3.61	52.38	125.0	30	10
Assíncrono	Média	10706	565	20950	5902.94	0.000%	29.46593	3.60	52.14	125.0	31	10
Assíncrono	Média	13216	649	25653	7209.99	0.000%	29.75239	3.63	52.65	125.0	30	5
Assíncrono	Média	13262	646	25808	7232.33	0.000%	29.60270	3.61	52.38	125.0	30	5
Assíncrono	Média	13202	673	25852	7281.45	0.000%	29.56144	3.61	52.31	125.0	30	5
Assíncrono	Média	15195	733	29859	8406.12	0.000%	29.55378	3.61	52.30	125.0	30	1
Assíncrono	Média	15301	712	29860	8422.58	0.000%	29.55186	3.61	52.29	125.0	30	1
Assíncrono	Média	15172	702	29571	8311.54	0.000%	29.83219	3.64	52.79	125.0	30	1
Assíncrono	Média	15267	732	29868	8437.35	0.000%	29.51647	3.60	52.23	125.0	30	1
Assíncrono	Média	15309	712	29967	8448.24	0.000%	29.44975	3.59	52.11	125.0	31	1
Assíncrono	Média	15436	712	29962	8417.78	0.000%	29.45546	3.60	52.12	125.0	31	1
Síncrono	Alta	1820	1006	24726	1571.96	0.000%	14.54970	8432.26	25.75	593458.3	454	450
Síncrono	Alta	4223	1055	42313	5390.97	0.000%	14.65028	8490.56	25.90	593458.3	454	450
Síncrono	Alta	1699	1018	23209	1413.80	0.000%	14.64119	8485.29	25.88	593458.3	451	450
Síncrono	Alta	3067	1000	34263	3827.71	0.000%	15.32409	8881.06	27.12	593458.3	431	430
Síncrono	Alta	1501	1005	12741	685.23	0.000%	15.32583	8882.07	27.09	593458.3	431	430
Síncrono	Alta	1522	1005	7809	377.78	0.000%	15.67796	9086.15	27.74	593458.3	421	420
Síncrono	Alta	3288	1050	32604	3980.18	0.000%	16.01310	9280.38	28.34	593458.3	412	410
Síncrono	Alta	2601	1019	35402	3210.51	0.000%	16.21963	9400.07	28.70	593458.3	407	400
Síncrono	Alta	3198	1023	43286	4611.17	0.000%	16.10761	9335.15	28.50	593458.3	410	400
Síncrono	Alta	3367	1013	53061	7010.84	0.000%	14.92831	8651.69	26.42	593458.3	442	400
Síncrono	Alta	2101	1026	19055	1496.36	0.000%	16.29218	9442.12	28.83	593458.3	405	400
Síncrono	Alta	3723	1029	33410	4470.75	0.000%	16.28765	9439.49	28.82	593458.3	405	400
Síncrono	Alta	3192	1043	27499	3086.45	0.000%	16.28588	9438.47	28.82	593458.3	405	400
Síncrono	Alta	24203	1088	70696	9541.89	0.010%	16.05721	9305.94	28.41	593458.3	411	390
Síncrono	Alta	40960	330	178712	20970.52	1.547%	13.14748	7502.22	22.88	584315.7		390
Síncrono	Alta	34682	539	443830	17442.38	0.408%	8.76042	5056.44	15.42	591044.3		390
Síncrono	Alta	11584	1041	54171	8553.30	0.010%	17.02726	9868.13	30.13	593458.3	388	380
Síncrono	Alta	28294	1017	86328	12939.28	0.010%	15.34098	8890.85	27.15	593458.3	430	380
Síncrono	Alta	25616	526	116122	17485.34	0.030%	13.88868	8046.75	24.57	593279.4	475	380
Síncrono	Alta	27940	532	69352	13649.43	0.018%	15.48851	8974.72	27.40	593349.9	364	370
Síncrono	Alta	26667	618	112095	13563.38	0.035%	14.41735	8352.62	25.50	593249.7	399	350
Síncrono	Alta	40513	1089	241365	23485.24	0.241%	6.29879	3641.39	11.12	591984.0	329	310
Assíncrono	Alta	431	397	1536	30.91	0.000%	27.48909	3.36	48.59	125.0	240	240
Assíncrono	Alta	431	393	1498	29.82	0.000%	27.48601	3.36	48.58	125.0	240	240
Assíncrono	Alta	482	400	1622	92.61	0.000%	28.62290	3.49	50.59	125.0	230	230
Assíncrono	Alta	459	403	1506	53.36	0.000%	28.67505	3.50	50.69	125.0	230	230
Assíncrono	Alta	784	413	2634	467.18	0.000%	29.70266	3.63	52.50	125.0	222	220
Assíncrono	Alta	1065	435	3331	647.91	0.000%	29.61310	3.61	52.34	125.0	223	220
Assíncrono	Alta	1233	428	4507	957.54	0.000%	29.47301	3.60	52.10	125.0	224	220
Assíncrono	Alta	5031	463	11901	3342.53	0.000%	29.80001	3.64	52.73	125.0	221	210
Assíncrono	Alta	4352	508	11331	2920.64	0.000%	29.90531	3.65	52.92	125.0	221	210
Assíncrono	Alta	4650	455	12804	3123.92	0.000%	29.86963	3.65	52.86	125.0	221	210
Assíncrono	Alta	11028	597	24199	6665.23	0.000%	29.51341	3.60	52.22	125.0	224	200
Assíncrono	Alta	10289	451	22520	6169.40	0.000%	29.71641	3.63	52.58	125.0	222	200
Assíncrono	Alta	11046	498	23886	6637.17	0.000%	29.53200	3.60	52.26	125.0	223	200
Assíncrono	Alta	10369	567	22385	6018.44	0.000%	29.75373	3.63	52.65	125.0	222	200
Assíncrono	Alta	9971	484	22091	6056.70	0.000%	29.77209	3.63	52.68	125.0	222	200
Assíncrono	Alta	9930	486	22375	5994.74	0.000%	29.73326	3.63	52.61	125.0	222	200
Assíncrono	Alta	15603	490	30633	9390.35	1.241%	29.98045	3.68	53.05	125.8	220	190
Assíncrono	Alta	16097	514	30638	9371.87	1.543%	29.98780	3.69	53.06	126.0	220	190
Assíncrono	Alta	16254	468	30767	9629.70	1.921%	29.97828	3.69	53.05	126.2	220	190
Assíncrono	Alta	19193	481	30651	10027.06	5.855%	31.41202	3.95	55.58	128.7	210	180
", sep = "\t", header = TRUE)

head(dados)

dados$Modo <- factor(dados$Modo)
dados$Carga <- factor(dados$Carga)
dados$Ramp.up <- as.numeric(dados$Ramp.up..sec.)
dados$Time <- as.numeric(dados$Time..sec.)
dados$Error.. <- as.numeric(gsub("%", "", dados$Error..))
dados$Throughput <- as.numeric(dados$Throughput)
dados$ErroPresente = ifelse(dados$Error.. > 0, TRUE, FALSE)

library(ggplot2)

jco_colors <- ggpubr::get_palette("jco", k = 2)

dados_otimos <- data.frame(
  Modo = c("Síncrono", "Assíncrono", "Síncrono", "Assíncrono"),
  Carga = c("Média", "Média", "Alta", "Alta"),
  Ramp.up = c(20, 1, 400, 200)
)
library(dplyr)
dados_otimos <- dados %>%
  semi_join(dados_otimos, by = c("Modo", "Carga", "Ramp.up")) %>%  
  group_by(Modo, Carga, Ramp.up) %>%  
  summarise(Throughput = mean(Throughput, na.rm = TRUE), .groups = "drop")

ggplot(dados, aes(x = Ramp.up, y = Throughput, color = Modo, shape = ErroPresente)) +
  geom_point(size = 3) +  
  facet_grid(~ Carga, scales = "free_x") +
  geom_vline(data = dados_otimos, aes(xintercept = Ramp.up, color = Modo),
             linetype = "dashed", size = 1) +  
  scale_shape_manual(values = c(`FALSE` = 16, `TRUE` = 17), labels = c("Sem Erro", "Com Erro")) +  
  scale_color_manual(values = jco_colors) +
  labs(
    x = "Ramp-up (segundos)",
    y = "Throughput (req/s)",
    color = "Modo",
    shape = "Erro"
  ) + theme_light()

